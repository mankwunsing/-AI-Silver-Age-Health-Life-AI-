<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ªæ€§åŒ–é¥®é£Ÿå»ºè®®åŠŸèƒ½æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">ä¸ªæ€§åŒ–é¥®é£Ÿå»ºè®®åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">åŠŸèƒ½æ¦‚è¿°</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-medium text-blue-800 mb-3">æ•°æ®æ”¶é›†</h3>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>â€¢ åŸºæœ¬ä¿¡æ¯ï¼ˆå¹´é¾„ã€æ€§åˆ«ã€èº«é«˜ã€ä½“é‡ã€BMIï¼‰</li>
                        <li>â€¢ å¥åº·æŒ‡æ ‡ï¼ˆè¡€å‹ã€å¿ƒç‡ã€è¡€ç³–ã€ä½“æ¸©ã€è¡€æ°§ï¼‰</li>
                        <li>â€¢ åŒ»ç–—å²å’Œç”¨è¯æƒ…å†µ</li>
                        <li>â€¢ ç”Ÿæ´»æ–¹å¼ï¼ˆè¿åŠ¨ã€ç¡çœ ã€å‹åŠ›ï¼‰</li>
                        <li>â€¢ é¥®é£Ÿè®°å½•å†å²</li>
                        <li>â€¢ è®¾å¤‡ç›‘æµ‹æ•°æ®</li>
                    </ul>
                </div>
                
                <div class="bg-green-50 p-4 rounded-lg">
                    <h3 class="font-medium text-green-800 mb-3">AIåˆ†æ</h3>
                    <ul class="text-sm text-green-700 space-y-1">
                        <li>â€¢ è¥å…»éœ€æ±‚åˆ†æ</li>
                        <li>â€¢ å…·ä½“é¥®é£Ÿå»ºè®®</li>
                        <li>â€¢ ç”¨é¤æ—¶é—´å»ºè®®</li>
                        <li>â€¢ ç‰¹æ®Šæ³¨æ„äº‹é¡¹</li>
                        <li>â€¢ è¥å…»è¡¥å……å»ºè®®</li>
                        <li>â€¢ åŸºäºè§„åˆ™çš„å¤‡ç”¨å»ºè®®</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">æµ‹è¯•åŠŸèƒ½</h2>
            <div class="flex flex-wrap gap-4">
                <button onclick="addTestHealthData()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded flex items-center">
                    <i class="fa fa-user mr-2"></i>æ·»åŠ æµ‹è¯•å¥åº·æ•°æ®
                </button>
                <button onclick="addTestDietRecords()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded flex items-center">
                    <i class="fa fa-cutlery mr-2"></i>æ·»åŠ æµ‹è¯•é¥®é£Ÿè®°å½•
                </button>
                <button onclick="testDietAdvice()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded flex items-center">
                    <i class="fa fa-lightbulb-o mr-2"></i>æµ‹è¯•é¥®é£Ÿå»ºè®®
                </button>
                <button onclick="clearTestData()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded flex items-center">
                    <i class="fa fa-trash mr-2"></i>æ¸…ç©ºæµ‹è¯•æ•°æ®
                </button>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">æµ‹è¯•ç»“æœ</h2>
            <div id="test-results" class="space-y-4">
                <div class="text-gray-500">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">åŠŸèƒ½ç‰¹ç‚¹</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h3 class="font-medium text-yellow-800 mb-2">ç»¼åˆåˆ†æ</h3>
                    <p class="text-sm text-yellow-700">æ•´åˆæ‰€æœ‰å¥åº·æ•°æ®ï¼Œæä¾›ä¸ªæ€§åŒ–å»ºè®®</p>
                </div>
                
                <div class="bg-purple-50 p-4 rounded-lg">
                    <h3 class="font-medium text-purple-800 mb-2">AIé©±åŠ¨</h3>
                    <p class="text-sm text-purple-700">ä½¿ç”¨AIåˆ†æï¼Œæä¾›ä¸“ä¸šè¥å…»å»ºè®®</p>
                </div>
                
                <div class="bg-pink-50 p-4 rounded-lg">
                    <h3 class="font-medium text-pink-800 mb-2">å¤‡ç”¨æœºåˆ¶</h3>
                    <p class="text-sm text-pink-700">AIä¸å¯ç”¨æ—¶ï¼Œæä¾›åŸºäºè§„åˆ™çš„å¤‡ç”¨å»ºè®®</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ·»åŠ æµ‹è¯•å¥åº·æ•°æ®
        function addTestHealthData() {
            // æ¨¡æ‹Ÿå¡«å†™å¥åº·æ•°æ®è¡¨å•
            const testData = {
                age: '65',
                gender: 'ç”·',
                height: '170',
                weight: '75',
                systolic: '145',
                diastolic: '90',
                heartRate: '85',
                glucose: '110',
                temperature: '36.5',
                spo2: '98',
                medicalHistory: 'é«˜è¡€å‹ã€ç³–å°¿ç—…',
                medications: 'é™å‹è¯ã€é™ç³–è¯',
                exercise: 'æ¯å‘¨æ•£æ­¥3æ¬¡',
                sleep: 'æ¯æ™š7å°æ—¶',
                stress: 'ä¸­ç­‰'
            };
            
            // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿï¼Œå®é™…åº”ç”¨ä¸­ä¼šå¡«å†™åˆ°è¡¨å•
            console.log('æµ‹è¯•å¥åº·æ•°æ®:', testData);
            updateResults('âœ… æµ‹è¯•å¥åº·æ•°æ®å·²æ·»åŠ ');
        }

        // æ·»åŠ æµ‹è¯•é¥®é£Ÿè®°å½•
        function addTestDietRecords() {
            const testRecords = [
                {
                    id: Date.now(),
                    mealTime: 'æ—©é¤',
                    foodContent: 'ç‡•éº¦ç²¥ã€é¸¡è›‹ã€ç‰›å¥¶ã€è‹¹æœ',
                    dietTime: new Date().toISOString(),
                    timestamp: new Date().toISOString()
                },
                {
                    id: Date.now() + 1,
                    mealTime: 'åˆé¤',
                    foodContent: 'ç³™ç±³é¥­ã€æ¸…è’¸é±¼ã€é’èœã€è±†è…æ±¤',
                    dietTime: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString(),
                    timestamp: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString()
                },
                {
                    id: Date.now() + 2,
                    mealTime: 'æ™šé¤',
                    foodContent: 'å°ç±³ç²¥ã€è’¸è›‹ã€è èœã€èƒ¡èåœ',
                    dietTime: new Date(Date.now() - 8 * 60 * 60 * 1000).toISOString(),
                    timestamp: new Date(Date.now() - 8 * 60 * 60 * 1000).toISOString()
                }
            ];
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            let dietRecords = JSON.parse(localStorage.getItem('dietRecords') || '[]');
            dietRecords.push(...testRecords);
            localStorage.setItem('dietRecords', JSON.stringify(dietRecords));
            
            console.log('æµ‹è¯•é¥®é£Ÿè®°å½•å·²æ·»åŠ :', testRecords);
            updateResults('âœ… æµ‹è¯•é¥®é£Ÿè®°å½•å·²æ·»åŠ ');
        }

        // æµ‹è¯•é¥®é£Ÿå»ºè®®
        async function testDietAdvice() {
            try {
                updateResults('ğŸ”„ æ­£åœ¨ç”Ÿæˆä¸ªæ€§åŒ–é¥®é£Ÿå»ºè®®...');
                
                // æ¨¡æ‹Ÿå¥åº·æ•°æ®
                const healthData = {
                    age: '65',
                    gender: 'ç”·',
                    height: '170',
                    weight: '75',
                    bmi: '26.0',
                    bloodPressure: { systolic: '145', diastolic: '90' },
                    heartRate: '85',
                    bloodGlucose: '110',
                    temperature: '36.5',
                    spO2: '98',
                    medicalHistory: 'é«˜è¡€å‹ã€ç³–å°¿ç—…',
                    medications: 'é™å‹è¯ã€é™ç³–è¯',
                    exerciseHabits: 'æ¯å‘¨æ•£æ­¥3æ¬¡',
                    sleepHabits: 'æ¯æ™š7å°æ—¶',
                    stressLevel: 'ä¸­ç­‰',
                    dietRecords: JSON.parse(localStorage.getItem('dietRecords') || '[]'),
                    deviceData: null
                };
                
                // ç”ŸæˆåŸºäºè§„åˆ™çš„å¤‡ç”¨å»ºè®®
                const advice = generateRuleBasedDietAdvice(healthData);
                
                // æ˜¾ç¤ºå»ºè®®
                displayTestAdvice(advice);
                updateResults('âœ… ä¸ªæ€§åŒ–é¥®é£Ÿå»ºè®®å·²ç”Ÿæˆ');
                
            } catch (error) {
                console.error('æµ‹è¯•é¥®é£Ÿå»ºè®®å¤±è´¥:', error);
                updateResults('âŒ æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }

        // åŸºäºè§„åˆ™çš„å¤‡ç”¨é¥®é£Ÿå»ºè®®
        function generateRuleBasedDietAdvice(healthData) {
            let advice = "åŸºäºæ‚¨çš„å¥åº·æ•°æ®ï¼Œä¸ºæ‚¨æä¾›ä»¥ä¸‹é¥®é£Ÿå»ºè®®ï¼š\n\n";
            
            // BMIåˆ†æ
            const bmi = parseFloat(healthData.bmi);
            if (bmi) {
                if (bmi < 18.5) {
                    advice += "ğŸ“Š **ä½“é‡åè½»**ï¼šå»ºè®®å¢åŠ è¥å…»å¯†åº¦é«˜çš„é£Ÿç‰©ï¼Œå¦‚åšæœã€å…¨è„‚å¥¶åˆ¶å“ã€ç˜¦è‚‰ç­‰ã€‚\n\n";
                } else if (bmi > 24) {
                    advice += "ğŸ“Š **ä½“é‡åé‡**ï¼šå»ºè®®æ§åˆ¶æ€»çƒ­é‡æ‘„å…¥ï¼Œå¢åŠ è”¬èœå’Œè›‹ç™½è´¨æ¯”ä¾‹ã€‚\n\n";
                } else {
                    advice += "ğŸ“Š **ä½“é‡æ­£å¸¸**ï¼šä¿æŒå‡è¡¡é¥®é£Ÿï¼Œç»´æŒå½“å‰å¥åº·çŠ¶æ€ã€‚\n\n";
                }
            }
            
            // è¡€å‹åˆ†æ
            const systolic = parseInt(healthData.bloodPressure.systolic);
            const diastolic = parseInt(healthData.bloodPressure.diastolic);
            if (systolic && diastolic) {
                if (systolic >= 140 || diastolic >= 90) {
                    advice += "ğŸ©º **è¡€å‹åé«˜**ï¼š\n";
                    advice += "- å‡å°‘é’ ç›æ‘„å…¥ï¼Œæ¯æ—¥ä¸è¶…è¿‡6å…‹\n";
                    advice += "- å¢åŠ å¯Œå«é’¾çš„é£Ÿç‰©ï¼šé¦™è•‰ã€æ©™å­ã€è èœ\n";
                    advice += "- é™åˆ¶åŠ å·¥é£Ÿå“å’Œè…Œåˆ¶é£Ÿå“\n\n";
                }
            }
            
            // è¡€ç³–åˆ†æ
            const glucose = parseInt(healthData.bloodGlucose);
            if (glucose) {
                if (glucose > 126) {
                    advice += "ğŸ¯ **è¡€ç³–åé«˜**ï¼š\n";
                    advice += "- æ§åˆ¶ç¢³æ°´åŒ–åˆç‰©æ‘„å…¥ï¼Œé€‰æ‹©ä½GIé£Ÿç‰©\n";
                    advice += "- å¢åŠ è†³é£Ÿçº¤ç»´ï¼šç‡•éº¦ã€è±†ç±»ã€è”¬èœ\n";
                    advice += "- å®šæ—¶å®šé‡è¿›é¤ï¼Œé¿å…æš´é¥®æš´é£Ÿ\n\n";
                }
            }
            
            // å¹´é¾„ç›¸å…³å»ºè®®
            const age = parseInt(healthData.age);
            if (age >= 60) {
                advice += "ğŸ‘´ **è€å¹´è¥å…»å»ºè®®**ï¼š\n";
                advice += "- å¢åŠ ä¼˜è´¨è›‹ç™½è´¨ï¼šé±¼ã€è›‹ã€è±†åˆ¶å“\n";
                advice += "- è¡¥å……é’™è´¨ï¼šå¥¶åˆ¶å“ã€èŠéº»ã€è™¾çš®\n";
                advice += "- å¢åŠ ç»´ç”Ÿç´ Dï¼šæ·±æµ·é±¼ã€è›‹é»„\n";
                advice += "- å¤šå–æ°´ï¼Œä¿æŒå……è¶³æ°´åˆ†\n\n";
            }
            
            // é€šç”¨å»ºè®®
            advice += "ğŸ¥— **é€šç”¨é¥®é£ŸåŸåˆ™**ï¼š\n";
            advice += "- å¤šæ ·åŒ–é¥®é£Ÿï¼Œæ¯å¤©è‡³å°‘5ç§ä¸åŒé¢œè‰²çš„è”¬èœæ°´æœ\n";
            advice += "- æ§åˆ¶æ²¹ç›ç³–æ‘„å…¥\n";
            advice += "- å®šæ—¶å®šé‡ï¼Œç»†åš¼æ…¢å’½\n";
            advice += "- ä¿æŒå……è¶³æ°´åˆ†ï¼Œæ¯æ—¥1500-2000ml\n\n";
            
            advice += "âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼šä»¥ä¸Šå»ºè®®ä»…ä¾›å‚è€ƒï¼Œå¦‚æœ‰ç‰¹æ®Šç–¾ç—…è¯·å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿæˆ–è¥å…»å¸ˆã€‚";
            
            return advice;
        }

        // æ˜¾ç¤ºæµ‹è¯•å»ºè®®
        function displayTestAdvice(advice) {
            const resultsDiv = document.getElementById('test-results');
            const formattedAdvice = advice.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            resultsDiv.innerHTML = `
                <div class="bg-blue-50 p-4 rounded-lg">
                    <div class="flex items-start">
                        <i class="fa fa-lightbulb-o text-blue-500 text-xl mr-3 mt-1"></i>
                        <div class="flex-1">
                            <h4 class="font-semibold text-blue-800 mb-2">AIä¸ªæ€§åŒ–é¥®é£Ÿå»ºè®®</h4>
                            <div class="text-blue-700 text-sm leading-relaxed">
                                ${formattedAdvice}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // æ¸…ç©ºæµ‹è¯•æ•°æ®
        function clearTestData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æµ‹è¯•æ•°æ®å—ï¼Ÿ')) {
                localStorage.removeItem('dietRecords');
                document.getElementById('test-results').innerHTML = '<div class="text-gray-500">æµ‹è¯•æ•°æ®å·²æ¸…ç©º</div>';
                console.log('æµ‹è¯•æ•°æ®å·²æ¸…ç©º');
            }
        }

        // æ›´æ–°æµ‹è¯•ç»“æœ
        function updateResults(message) {
            const resultsDiv = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const existingContent = resultsDiv.innerHTML;
            
            if (existingContent.includes('ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•')) {
                resultsDiv.innerHTML = `<div class="text-green-600">[${timestamp}] ${message}</div>`;
            } else {
                resultsDiv.innerHTML = existingContent + `<div class="text-green-600">[${timestamp}] ${message}</div>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ä¸ªæ€§åŒ–é¥®é£Ÿå»ºè®®åŠŸèƒ½æµ‹è¯•é¡µé¢å·²åŠ è½½');
        });
    </script>
</body>
</html>
